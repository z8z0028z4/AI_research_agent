# AI Research Agent 測試開發環境指南

## 🎯 為什麼需要測試？

想像一下，您正在蓋一棟房子：
- **沒有測試** = 蓋完房子後才發現牆壁歪了、水管漏水
- **有測試** = 每蓋一層樓都檢查一下，確保沒問題再繼續

測試就是幫我們**提前發現問題**，避免功能壞掉後才發現。

## 🏗️ 測試金字塔架構

### 什麼是測試金字塔？

測試金字塔就像蓋房子一樣，從基礎到頂層：

```
    🔺 端到端測試 (E2E) - 最少，最慢，最真實
   🔺🔺 整合測試 (Integration) - 中等，測試模組互動  
🔺🔺🔺 單元測試 (Unit) - 最多，最快，最頻繁
```

### 各層測試的用途

#### 1. 單元測試 (Unit Tests) - 基礎層
**比喻**：檢查每塊磚頭是否結實

**用途**：
- 測試個別功能是否正常
- 例如：測試「上傳文件」功能是否正確
- 執行時間：< 30 秒
- 使用頻率：**每天多次**

**什麼時候用**：
- 開發新功能時
- 修改現有功能時
- 確保小功能沒壞掉

#### 2. 整合測試 (Integration Tests) - 中間層
**比喻**：檢查牆壁是否穩固

**用途**：
- 測試多個功能組合是否正常
- 例如：測試「上傳文件 → 處理文件 → 儲存結果」整個流程
- 執行時間：< 2 分鐘
- 使用頻率：**每天幾次**

**什麼時候用**：
- 完成一個完整功能後
- 檢查功能之間的配合
- 確保流程沒問題

#### 3. 端到端測試 (E2E Tests) - 頂層
**比喻**：檢查整棟房子是否適合居住

**用途**：
- 測試完整的使用者操作流程
- 例如：測試「用戶登入 → 上傳文件 → 查詢結果 → 下載報告」完整流程
- 執行時間：< 5 分鐘
- 使用頻率：**每週幾次**

**什麼時候用**：
- 發布新版本前
- 檢查整個系統是否正常
- 模擬真實用戶使用情況

## 🚀 快速開始

### 第一步：安裝測試工具
```bash
# 安裝測試軟體
pip install pytest pytest-cov pytest-mock

# 進入測試目錄
cd tests
```

### 第二步：運行測試
我們提供了三個簡單的測試工具：

#### 🚀 快速測試 (推薦日常使用)
```bash
quick_test.bat
```
- **用途**：檢查基本功能是否正常
- **時間**：30 秒內完成
- **頻率**：每天多次使用

#### 🔍 完整測試
```bash
run_tests.bat
```
- **用途**：檢查所有功能是否正常
- **時間**：5-10 分鐘
- **頻率**：完成功能後使用

#### 📊 覆蓋率測試
```bash
coverage_test.bat
```
- **用途**：檢查測試是否完整
- **時間**：10-15 分鐘
- **頻率**：發布前使用

## 📁 測試文件說明

```
tests/
├── conftest.py              # 測試設定檔 (不用管)
├── pytest.ini              # 測試配置 (不用管)
├── test_core_modules.py    # 核心功能測試
├── test_services.py        # 服務功能測試
├── test_api.py             # 網頁介面測試
├── test_e2e.py             # 完整流程測試
├── run_tests.bat           # 主測試工具
├── quick_test.bat          # 快速測試工具
├── coverage_test.bat       # 覆蓋率測試工具
└── README.md               # 說明文件
```

## 🔧 日常開發流程

### 開發新功能時：

1. **開始工作前**
   ```bash
   quick_test.bat  # 確保環境正常
   ```

2. **開發過程中**
   ```bash
   python -m pytest test_core_modules.py -v  # 快速檢查
   ```

3. **完成功能後**
   ```bash
   run_tests.bat  # 完整檢查
   ```

4. **發布前**
   ```bash
   coverage_test.bat  # 檢查測試完整性
   ```

## 📊 測試指標說明

### 覆蓋率目標
- **代碼覆蓋率 > 90%**：90% 的程式碼都有被測試到
- **分支覆蓋率 > 85%**：85% 的程式邏輯分支都有被測試到
- **函數覆蓋率 > 95%**：95% 的函數都有被測試到

### 性能目標
- **單元測試 < 30 秒**：快速測試，不耽誤開發
- **整合測試 < 2 分鐘**：中等速度，可以接受
- **完整測試 < 10 分鐘**：完整檢查，時間合理

## 🛠️ 常見問題解決

### 問題 1：測試失敗了怎麼辦？

**步驟**：
1. 檢查錯誤訊息
2. 確認功能是否真的壞了
3. 如果是測試問題，聯繫團隊

### 問題 2：不知道要測試什麼？

**建議**：
1. 先測試基本功能
2. 再測試錯誤情況
3. 最後測試邊界情況

### 問題 3：測試太慢了？

**解決方案**：
1. 使用快速測試
2. 只測試相關功能
3. 優化測試環境

## 🎯 使用建議

### 日常開發
1. **開始工作前**：運行快速測試
2. **開發過程中**：定期檢查
3. **完成功能後**：運行完整測試
4. **發布前**：檢查覆蓋率

### 新功能開發
1. **設計階段**：想想要測試什麼
2. **實現階段**：邊寫邊測試
3. **測試階段**：確保功能正常
4. **文檔階段**：記錄測試案例

## 💡 關鍵優勢

### 1. 快速反饋
- 30 秒內知道功能是否正常
- 立即發現問題
- 減少除錯時間

### 2. 質量保障
- 自動化檢查
- 持續監控
- 預防問題

### 3. 開發效率
- 減少手動測試
- 提高信心
- 加速開發

### 4. 團隊協作
- 統一標準
- 清晰目標
- 自動化檢查

## 🚀 下一步行動

1. **立即使用**：運行 `quick_test.bat` 開始
2. **逐步學習**：根據需要調整
3. **持續改進**：定期檢查和優化
4. **團隊推廣**：分享給其他成員

## 📚 術語解釋

### 測試相關術語
- **單元測試**：測試最小的功能單位
- **整合測試**：測試多個功能的組合
- **端到端測試**：測試完整的用戶流程
- **覆蓋率**：程式碼被測試到的比例
- **Mock**：模擬外部依賴的工具
- **Fixture**：測試用的準備資料

### 技術術語
- **pytest**：Python 的測試框架
- **覆蓋率報告**：顯示測試完整性的報告
- **測試失敗**：測試沒有通過
- **測試通過**：測試成功
- **回歸測試**：確保修改沒有破壞現有功能

---

**記住**：測試就像保險一樣，平時可能覺得麻煩，但出問題時會很感謝有它！

現在您已經了解了測試的基本概念，可以開始使用測試工具來保障您的程式品質了！ 